<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: rating.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: rating.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/usr/bin/env node
'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @typedef {Object} Rating
 * @property {number} bula The game bula
 * @property {PrefPlayer} p1 The 1st PrefPlayer
 * @property {PrefPlayer} p2 The 2nd PrefPlayer
 * @property {PrefPlayer} p3 The 3rd PrefPlayer
 */
var math = require("mathjs");
/** @constant
 * @type {number}
 * @default
 */
var MAGIC = 2.8;
var _d = function (p1, p2, bula) {
    return math.round(math
        .chain(p1.score)
        .subtract(p2.score)
        .divide(bula)
        .done(), 3);
};
var _calculateDs = function (p1, p2, p3, bula) { return ({
    D12: _d(p1, p2, bula),
    D13: _d(p1, p3, bula),
    D23: _d(p2, p3, bula),
}); };
var _t = function (p1, p2) {
    return math.round(math
        .chain(p2.rating)
        .subtract(p1.rating)
        .multiply(MAGIC)
        .divide(100)
        .done(), 3);
};
var _calculateTs = function (p1, p2, p3) { return ({
    T12: _t(p1, p2),
    T13: _t(p1, p3),
    T23: _t(p2, p3),
}); };
var _n = function (p1, p2, bula) { return (p1.score > p2.score ? bula : p1.score &lt; p2.score ? -bula : 0) / 100; };
var _calculateNs = function (p1, p2, p3, bula) { return ({
    N12: _n(p1, p2, bula),
    N13: _n(p1, p3, bula),
    N23: _n(p2, p3, bula),
}); };
var _c = function (c1, c2) {
    return math.round(math
        .chain(c1)
        .add(c2)
        .divide(2)
        .done());
};
var _calculateChanges = function (p1, p2, p3, bula) {
    var D = _calculateDs(p1, p2, p3, bula);
    var T = _calculateTs(p1, p2, p3);
    var N = _calculateNs(p1, p2, p3, bula);
    var C12 = D.D12 + T.T12 + N.N12;
    var C13 = D.D13 + T.T13 + N.N13;
    var C23 = D.D23 + T.T23 + N.N23;
    return {
        change1: _c(C12, C13),
        change2: _c(-C12, C23),
        change3: _c(-C13, -C23),
    };
};
/** This is the Preferans Rating main class. */
var PrefRating = /** @class */ (function () {
    /** @constructor
     * @param {PrefPlayer} p1 - 1st player object
     * @param {PrefPlayer} p2 - 2nd player object
     * @param {PrefPlayer} p3 - 3rd player object
     * @param {number} bula - Game bula
     * @returns {object} PrefRating instance
     */
    function PrefRating(p1, p2, p3, bula) {
        this._p1 = p1;
        this._p2 = p2;
        this._p3 = p3;
        this._bula = bula;
        var _a = _calculateChanges(p1, p2, p3, bula), change1 = _a.change1, change2 = _a.change2, change3 = _a.change3;
        this._p1.change = change1;
        this._p2.change = change2;
        this._p3.change = change3;
    }
    /** Getter.
     * @returns {Rating} Rating as object
     */
    PrefRating.prototype.getObject = function () {
        return {
            bula: this._bula,
            p1: this._p1.getObject(),
            p2: this._p2.getObject(),
            p3: this._p3.getObject(),
        };
    };
    return PrefRating;
}());
exports.default = PrefRating;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#MAGIC">MAGIC</a></li><li><a href="global.html#PrefRating">PrefRating</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Dec 18 2018 10:35:19 GMT+0100 (W. Europe Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
